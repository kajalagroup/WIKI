<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="Set redirect URL after updated Django model in admin"><meta name=theme-color content="#FFFFFF"><meta name=color-scheme content="light dark"><meta property="og:title" content="Set redirect URL after updated Django model in admin"><meta property="og:description" content="Set redirect URL after updated Django model in admin"><meta property="og:type" content="article"><meta property="og:url" content="https://kajalagroup.github.io/wiki/posts/redirect-url-after-update-django-model/"><meta property="article:section" content="posts"><meta property="article:published_time" content="2021-12-15T00:00:00+00:00"><meta property="article:modified_time" content="2021-12-15T00:00:00+00:00"><title>Set redirect URL after updated Django model in admin | Kajala WIKI Book</title><link rel=manifest href=/wiki/manifest.json><link rel=icon href=/wiki/favicon.png type=image/x-icon><link rel=stylesheet href=/wiki/book.min.46181bc93375ba932026e753b37c40e6ff8bb16a9ef770c78bcc663e4577b1ba.css integrity="sha256-RhgbyTN1upMgJudTs3xA5v+LsWqe93DHi8xmPkV3sbo=" crossorigin=anonymous><script defer src=/wiki/flexsearch.min.js></script><script defer src=/wiki/en.search.min.8f2a33392d4e1b3e67386a930872b052980f1155e1ff2eb2d6c131f5d9470130.js integrity="sha256-jyozOS1OGz5nOGqTCHKwUpgPEVXh/y6y1sEx9dlHATA=" crossorigin=anonymous></script></head><body dir=ltr><input type=checkbox class="hidden toggle" id=menu-control>
<input type=checkbox class="hidden toggle" id=toc-control><main class="container flex"><aside class=book-menu><div class=book-menu-content><nav><h2 class=book-brand><a class="flex align-center" href=/wiki/><span>Kajala WIKI Book</span></a></h2><div class=book-search><input type=text id=book-search-input placeholder=Search aria-label=Search maxlength=64 data-hotkeys=s/><div class="book-search-spinner hidden"></div><ul id=book-search-results></ul></div><ul><li class=book-section-flat><span>General</span><ul><li><a href=https://kajalagroup.github.io/wiki/docs/general/hello/>Hello</a></li></ul></li></ul><ul><li><a href=/wiki/posts/>Posts</a></li></ul></nav><script>(function(){var a=document.querySelector("aside .book-menu-content");addEventListener("beforeunload",function(b){localStorage.setItem("menu.scrollTop",a.scrollTop)}),a.scrollTop=localStorage.getItem("menu.scrollTop")})()</script></div></aside><div class=book-page><header class=book-header><div class="flex align-center justify-between"><label for=menu-control><img src=/wiki/svg/menu.svg class=book-icon alt=Menu></label>
<strong>Set redirect URL after updated Django model in admin</strong>
<label for=toc-control><img src=/wiki/svg/toc.svg class=book-icon alt="Table of Contents"></label></div><aside class="hidden clearfix"><nav id=TableOfContents></nav></aside></header><article class=markdown><h1><a href=/wiki/posts/redirect-url-after-update-django-model/>Set redirect URL after updated Django model in admin</a></h1><h5>December 15, 2021</h5><div><a href=/wiki/categories/development/>Development</a>,
<a href=/wiki/categories/django/>Django</a></div><div><a href=/wiki/tags/django/>Django</a>,
<a href=/wiki/tags/backend/>backend</a></div><p>Currently if you do a filter or search in list view in admin in Django, after update a row in given list (Django will open edit page). After that model is updated, Django will redirect to list url without keep search or filter condition that you made before.</p><p>Here is the solution to make Django redirect to previous list view url.</p><p>Firstly, you need define own ChangeList.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py>
<span style=color:#f92672>from</span> jutil.admin <span style=color:#f92672>import</span> admin_obj_url
<span style=color:#f92672>from</span> django.contrib.admin.views.main <span style=color:#f92672>import</span> ChangeList
<span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MyChangeList</span>(ChangeList):
    <span style=color:#66d9ef>def</span> __init__(self, request, <span style=color:#f92672>*</span>args):
        super()<span style=color:#f92672>.</span>__init__(request, <span style=color:#f92672>*</span>args)
        self<span style=color:#f92672>.</span>current_url <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>get_full_path()  <span style=color:#75715e># Store  current url</span>

    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>url_for_result</span>(self, result):
        <span style=color:#66d9ef>return</span> admin_obj_url(result) <span style=color:#f92672>+</span> <span style=color:#e6db74>&#34;?next=&#34;</span> <span style=color:#f92672>+</span> mark_safe(self<span style=color:#f92672>.</span>current_url)  <span style=color:#75715e># Add current url to next param when open update url.</span>
</code></pre></div><p>Next here is code in your model admin class.</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-py data-lang=py>
<span style=color:#f92672>from</span> django.contrib <span style=color:#f92672>import</span> admin
<span style=color:#f92672>from</span> django.shortcuts <span style=color:#f92672>import</span> redirect
<span style=color:#66d9ef>class</span> <span style=color:#a6e22e>MyAdmin</span>(admin<span style=color:#f92672>.</span>ModelAdmin):
    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>get_changelist</span>(self, request, <span style=color:#f92672>**</span>kwargs):
        <span style=color:#66d9ef>return</span> MyChangeList

    <span style=color:#66d9ef>def</span> <span style=color:#a6e22e>response_post_save_change</span>(self, request, obj):
        <span style=color:#66d9ef>if</span> <span style=color:#e6db74>&#39;next&#39;</span> <span style=color:#f92672>in</span> request<span style=color:#f92672>.</span>GET:  <span style=color:#75715e># Check if next is passed via url, redirect to previous url</span>
            next_url <span style=color:#f92672>=</span> request<span style=color:#f92672>.</span>GET[<span style=color:#e6db74>&#39;next&#39;</span>]
            <span style=color:#66d9ef>return</span> redirect(next_url)
        <span style=color:#66d9ef>return</span> super()<span style=color:#f92672>.</span>response_post_save_change(request, obj)
</code></pre></div></article><footer class=book-footer><div class="flex flex-wrap justify-between"></div><script>(function(){function a(c){const a=window.getSelection(),b=document.createRange();b.selectNodeContents(c),a.removeAllRanges(),a.addRange(b)}document.querySelectorAll("pre code").forEach(b=>{b.addEventListener("click",function(c){a(b.parentElement),navigator.clipboard&&navigator.clipboard.writeText(b.parentElement.textContent)})})})()</script></footer><div class=book-comments></div><label for=menu-control class="hidden book-menu-overlay"></label></div><aside class=book-toc><div class=book-toc-content><nav id=TableOfContents></nav></div></aside></main></body></html>